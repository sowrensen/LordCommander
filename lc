#!/usr/bin/env python3
"""
| ---------------------------------------------------------------------
| lc.py
| ---------------------------------------------------------------------
| LordCommander (hence, lc.py) is a python program to run a shell
| command recursively through predefined directories.
|
| Version: 3.0
| License: GNU General Public License 3
"""

import os
import shelve
from fire import Fire
from utils import Utils
from output import Output
from controllers import DirectoryController, CommandController


class LordCommander:
    """
    üêà Run a shell command recursively throughout the predefined directories.
    """
    
    def __init__(self):
        try:
            # Read files or create them if doesn't exist
            if not os.path.exists('.files'):
                os.mkdir('.files')
            self._dirs_shelve = shelve.open('.files/dirs')
            self.dirs = DirectoryController(self._dirs_shelve)
            self.utils = Utils(self._dirs_shelve)
        except IOError as error:
            Output.write(error)
    
    def run(self, command, li=0, ui=None):
        """
        Run a shell command throughout the saved directories.
        :param command: The command to run
        :param li: Lower index (optional)
        :param ui: Upper index (optional)
        """
        cc = CommandController()
        cc.run(self._dirs_shelve, command, li, ui)


if __name__ == "__main__":
    # The event horizon
    Fire(LordCommander)
